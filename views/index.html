<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <title>You Pay Me</title>
  </head>

  <body style="font-family: 'Poppins', sans-serif">
    <section class="text-gray-600 body-font relative">
      <div class="container px-5 py-16 mx-auto">
        <div class="flex flex-col text-center w-full mb-8">
          <img
            src="https://i.postimg.cc/qq4txjHH/hands.png"
            alt="hands"
            class="inline-block w-44 mx-auto"
          />
          <h1
            class="sm:text-3xl text-2xl font-medium title-font mb-4 text-gray-900"
          >
            You Pay Me
          </h1>
          <p class="lg:w-2/3 mx-auto leading-relaxed text-base">
            Simple way to create payment link with predefined amount with UPI
          </p>
        </div>
        <div class="lg:w-1/2 md:w-2/3 mx-auto">
          <div class="flex flex-wrap -m-2">
            <div class="p-2 w-1/2">
              <div class="relative">
                <label for="fName" class="leading-7 text-sm text-gray-600"
                  >Name
                  <span style="color: red; font-size: large">*</span></label
                >
                <input
                  id="fName"
                  name="fName"
                  placeholder="Enter your name"
                  class="w-full bg-gray-100 bg-opacity-50 rounded border border-gray-300 focus:border-indigo-500 focus:bg-white focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"
                />
              </div>
            </div>
            <div class="p-2 w-1/2">
              <div class="relative">
                <label for="upi" class="leading-7 text-sm text-gray-600"
                  >UPI ID
                  <span style="color: red; font-size: large">*</span></label
                >
                <input
                  type="email"
                  id="upi"
                  name="upi"
                  placeholder="example@upi"
                  class="w-full bg-gray-100 bg-opacity-50 rounded border border-gray-300 focus:border-indigo-500 focus:bg-white focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"
                />
              </div>
            </div>
            <!-- <div class="p-2 w-1/2">
                        <div class="relative">
                            <label for="name" class="leading-7 text-sm text-gray-600">UPI Id</label>
                            <input type="text" id="name" name="name"
                                class="w-full bg-gray-100 bg-opacity-50 rounded border border-gray-300 focus:border-indigo-500 focus:bg-white focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out">
                        </div>
                    </div> -->
            <div class="p-2 w-full">
              <div class="relative">
                <label for="amount" class="leading-7 text-sm text-gray-600"
                  >Amount
                  <span style="color: red; font-size: large">*</span></label
                >
                <input
                  type="number"
                  id="amount"
                  name="amount"
                  placeholder="eg : 100.00"
                  class="w-full bg-gray-100 bg-opacity-50 rounded border border-gray-300 focus:border-indigo-500 focus:bg-white focus:ring-2 focus:ring-indigo-200 text-base outline-none text-gray-700 py-1 px-3 leading-8 transition-colors duration-200 ease-in-out"
                />
              </div>
            </div>
            <div class="p-2 w-full">
              <div class="relative">
                <label for="message" class="leading-7 text-sm text-gray-600"
                  >Transaction Note (If any)</label
                >
                <textarea
                  id="message"
                  name="message"
                  placeholder="(Optional) Any note upto 80 characters"
                  maxlength="80"
                  class="w-full bg-gray-100 bg-opacity-50 rounded border border-gray-300 focus:border-indigo-500 focus:bg-white focus:ring-2 focus:ring-indigo-200 h-24 text-base outline-none text-gray-700 py-1 px-3 resize-none leading-6 transition-colors duration-200 ease-in-out"
                ></textarea>
              </div>
            </div>
            <div class="p-2 mx-auto text-center w-full">
              <div hidden id="alertBox">
                <div
                  class="flex p-4 mb-4 text-sm text-green-700 bg-green-100 rounded-lg dark:bg-green-200 dark:text-green-800 animate-bounce"
                  role="alert"
                >
                  <svg
                    aria-hidden="true"
                    class="flex-shrink-0 inline w-5 h-5 mr-3"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                      clip-rule="evenodd"
                    ></path>
                  </svg>
                  <span class="sr-only">Info</span>
                  <div>
                    <span class="font-medium"
                      >Payment Link copied to your clipboard</span
                    >
                  </div>
                </div>
              </div>
              <div id="copyBox" hidden>
                <div
                  class="flex items-center w-full mx-auto bg-gray-200 rounded-lg"
                >
                  <div class="w-full">
                    <input
                      type="text"
                      class="w-full px-4 py-1 text-gray-800 rounded-full focus:outline-none bg-gray-200"
                      id="pLink"
                      placeholder=""
                      readonly
                    />
                  </div>

                  <div>
                    <button
                      type="copy"
                      id="copyButton"
                      class="flex items-center bg-lime-500 justify-center w-12 h-12 text-white rounded-r-lg"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        class="h-6 w-6"
                        fill="none"
                        viewBox="0 0 24 24"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                        />
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <!-- create a textfield with link and a copy button beside it -->

              <div class="flex flex-row justify-center items-center">
                <button
                  type="button"
                  id="generate"
                  class="m-4 text-white bg-gradient-to-br from-emerald-500 to-lime-400 hover:bg-gradient-to-bl inline-flex items-center focus:outline-none focus:ring-blue-300 dark:focus:ring-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center mr-2"
                >
                  Generate payment link
                </button>
                <div id="openLinkBox" hidden>
                  <button
                    id="openLink"
                    class="relative inline-flex items-center justify-center p-0.5 overflow-hidden text-sm font-medium text-gray-900 rounded-lg group bg-gradient-to-br from-teal-300 to-lime-300 group-hover:from-teal-300 group-hover:to-lime-300"
                  >
                    <span
                      class="relative px-5 py-2.5 transition-all ease-in duration-75 bg-white rounded-md"
                    >
                      Open Link
                    </span>
                  </button>
                </div>
              </div>
            </div>
            <div
              class="p-2 w-full pt-8 mt-8 border-t border-gray-200 text-center"
            >
              <!-- <a class="text-indigo-500">example@email.com</a>
                        <p class="leading-normal my-5">49 Smith St.
                            <br>Saint Cloud, MN 56301
                        </p>
                        <span class="inline-flex">
                            <a class="text-gray-500">
                                <svg fill="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    class="w-5 h-5" viewBox="0 0 24 24">
                                    <path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"></path>
                                </svg>
                            </a>
                            <a class="ml-4 text-gray-500">
                                <svg fill="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    class="w-5 h-5" viewBox="0 0 24 24">
                                    <path
                                        d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z">
                                    </path>
                                </svg>
                            </a>
                            <a class="ml-4 text-gray-500">
                                <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                                    stroke-width="2" class="w-5 h-5" viewBox="0 0 24 24">
                                    <rect width="20" height="20" x="2" y="2" rx="5" ry="5"></rect>
                                    <path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zm1.5-4.87h.01"></path>
                                </svg>
                            </a>
                            <a class="ml-4 text-gray-500">
                                <svg fill="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    class="w-5 h-5" viewBox="0 0 24 24">
                                    <path
                                        d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z">
                                    </path>
                                </svg>
                            </a>
                        </span> -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <script>
      var fname = document.getElementById("fName");
      var upi = document.getElementById("upi");
      var amount = document.getElementById("amount");
      var message = document.getElementById("message");
      var pLink = document.getElementById("pLink");
      var copyButton = document.getElementById("copyButton");
      var generate = document.getElementById("generate");
      var copyBox = document.getElementById("copyBox");
      var openLink = document.getElementById("openLink");
      var openLinkBox = document.getElementById("openLinkBox");
      var alertBox = document.getElementById("alertBox");

      generate.addEventListener("click", function () {
        const upiRegEx = new RegExp(/[a-zA-Z0-9.\-_]{2,256}@[a-zA-Z]{2,64}/);
        const amountRegEx = new RegExp(/^[0-9]+(\.[0-9]{1,2})?$/);
        const nameRegEx = new RegExp(/^[a-zA-Z ]{2,256}$/);
        console.log(fname.value);
        console.log(upi.value);
        if (
          upiRegEx.test(upi.value) &&
          amountRegEx.test(amount.value) &&
          nameRegEx.test(fname.value)
        ) {
          currUrl = window.location.href;
          pLink.value =
            currUrl +
            `pay?pa=${upi.value}&pn=${fname.value}&am=${amount.value}`;
          if (message.value) {
            pLink.value += `&tn=${message.value}`;
          }
          pLink.value = encodeURI(pLink.value);

          console.log(pLink.value);

          copyBox.removeAttribute("hidden");
          openLinkBox.removeAttribute("hidden");
          copyButton.click();
        } else {
          alert("Please fill all the fields correctly");
        }
      });

      copyButton.addEventListener("click", function () {
        pLink.select();
        document.execCommand("copy");
        console.log("Copied to clipboard");
        showAlert();
      });

      openLink.addEventListener("click", function () {
        window.open(pLink.value, "_blank");
      });

      function showAlert() {
        alertBox.removeAttribute("hidden");
        setTimeout(function () {
          alertBox.setAttribute("hidden", true);
        }, 3000);
      }
    </script>
  </body>
</html>
